<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Semantic Segmentation | Bhabaranjan Panigrahi</title> <meta name="author" content="Bhabaranjan Panigrahi"> <meta name="description" content="DeepLabV3 backbone comparision between ResNet and MobileNet"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://profile.bpanigrani.com/projects/4_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Bhabaranjan </span>Panigrahi</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/"> Blogs</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Semantic Segmentation</h1> <p class="post-description">DeepLabV3 backbone comparision between ResNet and MobileNet</p> </header> <article> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
Source Code available in the repository
Github handle: bhaba-ranjan
Project: Semantic Segmentation
Repository: https://github.com/bhaba-ranjan/DeepLabV3
---
</code></pre></div></div> <h4 id="1-introduction">1. Introduction</h4> <p>Semantic segmentation is a classical computer vision problem which involves assigning labels or categories to each pixel. Unlike the image classification task which classifies an image overall, image segmentation deals with classifying each pixel to understand the visual content of the image at pixel level. This introduces unique challenges in developing semantic segmentation models. Because, apart from high level understanding, it needs low level understanding and localization to identify where an object is present in an image. Semantic segmentation is used in a variety of applications including autonomous driving and medical imaging. Some of the key application areas are discussed in the following paragraph.</p> <p>Image segmentation is very popular in various video and image editing applications for automatically outlining borders, object replacement and background removal are some of the key usages. It is heavily used for scene understanding in several applications including robotics, autonomous driving, surveillance systems where accurate perception of the environment is a critical component. Apart from these applications it is also popular in medical imaging for identifying abnormalities in CT and MRI scans. In our work we took a popular semantic segmentation model named DeepLabV3 and tested its adaptation on a different dataset with some popular backbone networks.</p> <h4 id="2-related-work">2. Related Work</h4> <p>The advent of neural networks has led to significant improvement in the accuracy of semantic segmentation tasks. Most of these learning based algorithms use a lot of classical computer vision concepts in order to achieve fine grained segmentation capabilities. Over time there have been a lot of changes and new components introduced to do semantic segmentation in an accurate and robust manner. Some of the popular work is discussed in this section.</p> <p>Fully Convolutional Networks (FCN) was introduced in 2014 as one of the preliminary works that used convolutional neural networks to do semantic segmentation. It replaced fully connected layers in the network with upsampling techniques such as interpolation and transposed convolution to restore the spatial resolution in the output. FCN suffered from limited contextual information. In the following year to create more accurate feature maps another paper introduced U-Net [2] which used direct connection from the encoder to improve on the performance by gaining access to some of the high and low level features in the decoder layer. DeepLab was initially introduced in 2014 but improved dramatically in its following incremental improvement iterations (DeepLabV2 and DeepLabv3[3]). The DeepLab model employed several other techniques in addition to the regular encoder-decoder based architecture to improve significantly on several computer vision benchmark datasets. Some of the key details of the DeepLabV3 model are discussed in the following sections.</p> <p>Another line of work extended the faster R-CNN object detection algorithm by adding a branch for pixel level segmentation. Mask R-CNN are widely popular for tasks that require both object detection and segmentation. One of the other notable lines of work is EfficientNet [4], it focused more on improving efficiency and performance tradeoff in deep learning models. It introduces compound scaling which uniformly scales network depth, width and resolution to find a balance between computational efficiency and accuracy.</p> <h4 id="3-deeplabv3-architecture">3. DeepLabV3 Architecture</h4> <p>In this section we will be discussing some of the key architecture details of DeepLabV3, the thought process behind using them and how they influence the end result of segmenting an image.</p> <p>Following are some of the key components of DeepLabV3 network that made deeplabV3 accurate and each of these is covered in detail in the following section.</p> <ol> <li>Use of dilated convolutions</li> <li>Artous spatial pyramid pooling</li> <li>Conditional random fields</li> </ol> <h5 id="31-dilated-convolution">3.1 Dilated Convolution</h5> <p>Dilated convolution unlike regular convolution takes an additional parameter known as dilation rate. Dilation rate refers to the spacing between the kernels. With a dilation rate of 1 it is the same as regular convolution without any spacing but as it increases the spacing between the kernels increases. Dilation rate enables capturing information at multiple scales without losing the spatial resolution.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/s-1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/s-1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/s-1-1400.webp"></source> <img src="/assets/img/s-1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>A dilation rate greater than one increases the receptive field by skipping input pixels based on the specified rate. As this method preserves spatial resolution at multiple scales it is a crucial component of image segmentation problems. This property is exploited in DeepLabV3 in different ways; it helps models to learn representation with varying abstraction and details [5] which is extremely important for semantic segmentation tasks. Figure 1 is a pictorial representation of dilated convolution.</p> <h4 id="32-artous-spatial-pyramid-pooling">3.2 Artous Spatial Pyramid Pooling</h4> <p>This pooling operation made DeepLabV3 robust at capturing multi-scale contextual information which is an essential part of semantic segmentation. In this paper [6], where parallel atrous convolution is applied with different dilation rates to effectively do semantic segmentation. The paper showed that effective resampling of features at different scales could potentially increase accuracy in identifying images at multiple scales. Following diagram is a depiction of Aspp.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/s-2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/s-2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/s-2-1400.webp"></source> <img src="/assets/img/s-2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>For ASPP DeepLabV3 uses multiple parallel branches, each having a different dilation rate. Number of parallel branches is determined by the scale variation required to extract context. Apart from the number of branches it is crucial to select a proper dilation rate which will capture information and adapt to objects of different sizes in the input image. The output feature maps of the branches are then combined to form a rich feature representation of the image to enable the model to do accurate semantic segmentation. ASPP enabled DeepLabV3 to focus both on fine-grained details and high level context at the same time.</p> <h5 id="33-conditional-random-fields-crf">3.3 Conditional Random Fields (CRF)</h5> <p>Although DeepLabV3 is able to outperform most of the contemporary models without CRF, including CRF as a post processing technique could further improve segmented object boundaries. ASPP is successful in covering various receptive fields and capturing fine grained details however the large receptive field and scale variance yield smooth responses. Though this time ASPP significantly improved the image boundary over DeepLabV2 and was able to outperform it in benchmarks. Conditional random fields define an energy function that ensures consistent labelling of neighbouring pixels. It uses two gaussian kernels in different feature spaces; the first bilateral kernel is in pixel position and intensity space while the second one only depends on the pixel position[7].</p> <h5 id="4-experimental-setup">4. Experimental Setup</h5> <p>In our work we are interested in seeing how the model performs in terms of adapting to a new data set on which it is not trained previously and how it performs for different backbone as feature extractors. We primarily used two backbone networks as feature extractors that are ResNet-50 and MobileNet. The backbones are pre trained on the ImageNet dataset. We took pretrained weights of DeepLabV3 trained on PASCAL VOC 2012 dataset and then fine tuned the model to accommodate for Cityscapes dataset as they have different numbers of classes.</p> <p>Initial DeepLabV3 has the mIoU of 0.79 for ResNet-50 and 0.7 for MobileNet on PASCAL VOC dataset. Then we trained the model using cross entropy loss. We used SGD stochastic gradient descent for optimization with a learning rate of 0.001 for the DeepLabV3 model and 0.0001 for backbone network with the same optimization technique.</p> <h5 id="41-experimental-results-and-analysis">4.1 Experimental Results and Analysis</h5> <p>Initially without any training just with pretrained weights on PASCAL we passed an image from the Cityscape dataset to the network and observed the following output.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/s-3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/s-3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/s-3-1400.webp"></source> <img src="/assets/img/s-3.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>It is evident from the initial prediction that the model is able to recognize the object it has seen before in the dataset (PASCAL) it is previously trained on, although the boundaries are not very sharp. As the PASCAL dataset contains instances of cars, pedestrians, buses and cyclists the model is able to recognize them even with the default weights. However, the model could not recognize traffic lights and signs as it has not seen it before in the PASCAL dataset.</p> <p>After this observation we started training the model on the Cityscape dataset and validated the model on every 5th iteration and kept some of the results to understand how the model is adapting to the new dataset in consequent iterations.</p> <p>Following are some observations of validation set at different mIoU.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/s-4-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/s-4-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/s-4-1400.webp"></source> <img src="/assets/img/s-4.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/s-5-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/s-5-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/s-5-1400.webp"></source> <img src="/assets/img/s-5.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>From figure 4 we could see that the IoU goes down as soon as we start training because the model starts adapting to the new colour encoding of the Cityscape dataset. We observed that during validation the model was able to adapt to the objects it has seen before at a much earlier level than the object it has not seen before. As it can be seen the model is able to adapt to pedestrians and cars quickly in the earlier iteration in ResNet-50 mIoU 0.27 and gradually it learns to segment the object it has not seen before like traffic lights and signs which can be seen in MobileNet mIoU 0.4 image.</p> <p>Apart from the adaptation to the image segmentation we also monitored the improvements in mIoU over the validation sets for different networks. The following figure is a depiction of the same.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/s-6-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/s-6-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/s-6-1400.webp"></source> <img src="/assets/img/s-6.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>As it can be seen from the graphs that the mIoU initially drops as the model starts adapting to the new class scheme but as soon as it adopts the new class masks the IoU starts increasing rapidly in the following iterations. Another observation that can be drawn from the graphs is that at each iteration end of the validation set the MobileNet backbone model is able to get higher mIoU scores in most of the cases as compared to the ResNet-50 backbone model. Even in the final iteration, the ResNet-50 model was able to achieve 0.32 in mIoU score but MobileNet reached up to 0.4 in mIoU score. We think that this is because ResNet-50 is larger because of the number of layers; however, MobileNet is much smaller and is designed for devices with low computational resources.</p> <h5 id="5-conclusion">5. Conclusion</h5> <p>In our project we are successfully able to run DeepLabV3 with a different backbone and able to quantify some of the key differences in terms of performance and adaptation to new data. We observed that both of these metrics are influenced by the distribution of data the model is previously trained on as well as the backbone it uses. We also learned that backbone should be chosen carefully according to application requirements, for example for faster inference and low resource devices MobileNet should be used whereas ResNet-50 has the potential to give more accuracy if sufficiently trained. Motivated by our work we further want to run similar analysis on popular models that use transformers for semantic segmentation in our future work</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Bhabaranjan Panigrahi. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>