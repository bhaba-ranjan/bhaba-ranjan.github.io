<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Clustering | Bhabaranjan Panigrahi</title> <meta name="author" content="Bhabaranjan Panigrahi"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://profile.bpanigrani.com/projects/2_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Bhabaranjan </span>Panigrahi</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/"> Blogs</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Clustering</h1> <p class="post-description"></p> </header> <article> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
Source Code available in the repository
Github handle: bhaba-ranjan
Project: clustering
Repository: https://github.com/bhaba-ranjan/clustering
---
</code></pre></div></div> <h4 id="1-overview">1. Overview</h4> <p>As described in the problem statement. The given dataset consists of pixel values of digits. The dimension of the data set is 784. They all corresponds to picture of size 28*28 pixels. In two dimensions. The objective is to cluster similar digits together. To achieve the objective several steps were performed. They are broadly categorized into the following.</p> <ol> <li>Data Analysis</li> <li>Data Preprocessing</li> <li>Dimensionality Reduction</li> <li>Running K-means clustering and Analysis</li> </ol> <h4 id="2-data-analysis">2. Data Analysis</h4> <p>So the given dimension of data is 784. Each of this feature represents a number between 0-255 representing their color in the original image of size 28<em>28 pixels. The first thing I tried is to recreate the image based on the gray scale so that I can have an idea of the different digits. As, the original image is of 28</em>28 pixels. I resized it as a 2 dimensional grid. And then visualized it through the cv2 library. I found out that different styles of the same digit exist in the dataset. Some findings are below.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/clustering1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/clustering1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/clustering1-1400.webp"></source> <img src="/assets/img/clustering1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>This means that we cannot take the accurate representation of the pixels and achieve good clustering results. Another important finding is that a lot of pixels are 0. For some columns almost all pixels are zero. I have visualization and more discussion about this in the dimensionality reduction section.</p> <h4 id="3-data-preprocessing">3. Data Preprocessing</h4> <p>As from the above analysis, it is clear that plotting direct pixel values in a high dimensional space is not going to add any meaningful value to our clustering algorithm. As the pixel of each digit could vary a lot because of the different style of the same digit.</p> <p>For this reason I decided to make them more similar. The reason behind this is, if I could make images of the same digit similar by applying some logic they would fall near each other. This would result in better clustering. To be specific, the intra cluster distance will be reduced. It is known that minimizing intra cluster distance results in a better clustering overall.</p> <p>One way to achieve this is to ignore some features that are very specific to a certain style. By doing this we would achieve a better generalization. As we are less biased towards certain features and looking at the overall construction of images. Overall construction is very similar for a digit, so we could generalize them well and present them near to each other in a high dimensional space.</p> <p>To achieve this we could use averaging, average takes a n*n grid matrix and averages those pixel values. This window averaging technique is applied for all the pixels in the image. This results in a smoother image. As a result more fine grained details are lost and images start to look similar and cluster near each other for the same digits. I am also using gaussian smoothing in order to remove any gaussian noise. It works the same as averaging but the matrix value is derived from a gaussian curve. After applying this smoothening technique these are the resulting images. As you could notice images are Are now a lot smoother. The sharpness is less and they generalize well in terms of pixel colors.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/clustering2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/clustering2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/clustering2-1400.webp"></source> <img src="/assets/img/clustering2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h4 id="4-dimensionality-reduction">4. Dimensionality Reduction</h4> <p>It was not very difficult to spot that we need some reduction in dimension. But choosing the right method and tuning the parameter was very critical for the problem. Initially by just looking at the data I could see a lot of zeros around the first few columns. So, I wanted to check how sparse the data is. In order to understand the features and their representation better, I used a heatmap to visualize how many features actually represent enough colors. On the left the heatmap represents the features on the vertical axis and respective color counts in the horizontal axis.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/clustering3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/clustering3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/clustering3-1400.webp"></source> <img src="/assets/img/clustering3.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Vertical axis (0-783)represts feature and Horizontal axis represent colors counts(0-225) The darkest color represents count more than 10 and the light color at the bottom represents 0</b> </div> <p>As we could clearly see from the heatmap that a lot of features do not represent any meaningful color, all of that row is just the lightest color representing 0 for all the colors. Also, the left most column for representing color 0 has the darkest color for all features. Which means almost all features have a lot of pixels with color 0.</p> <h5 id="41-pca">4.1 PCA</h5> <p>It is clear from the previous analysis that a lot of the features do not represent any meaningful color. A lot of them have color 0 in excess. It does not make any distinction between. So, I used PCA to reduce redundant features and merge them into one generic feature. This helped a lot in reducing dimension. PCA tries to project the dataset into a hyperplane but it chooses the plane that retains the maximum variance of the data set. In this case Instead of specifying n_component to a specific number. I set it to 0.99 which means to find a hyperplane that preserves 99% variance of the original dataset. I found it to be useful for not losing meaningful details. After running PCA I am able to reduce the dimension of the dataset from 784 down to 86.</p> <h5 id="41-learning-manifolds">4.1 Learning Manifolds</h5> <p>It was one of the most important parts of solving the problem. Learning manifolds is another dimensionality reduction technique. It is a lot different from PCA. While PCA tries to find a hyperplane, manifold learning is about learning a hyperplane which is twisted in the high dimensional space. In general manifold learning projects n dimensional data to d dimension where d &lt; n that resembles</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/clustering4-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/clustering4-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/clustering4-1400.webp"></source> <img src="/assets/img/clustering4.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>d-dimensional hyperplane locally. We could understand this by using a popular dataset. As we can already see on the rightmost side for swiss roll dataset PCA is not alway the best option if the dataset is twisted. However, manifold captures the property of the data verywell. I am using t-SNE manifold learning technique for further reducing the dimension of the data to 2-Dimension. I am using parameter perplexity set to 19 which looks at the k-neighbor in order to decide between the attention between local and global data. early_exagration is set to 26; this parameter exaggerates the distance between two clusters more than usual. This helps in clustering because we want clusters that are far apart to avoid conflicting data points as much as possible. Based on the perplexity parameter value it could have a different shape. The choice of this value is critical mostly in between 5-50. I tried different smaller and larger values and based on the visualization I kind of did like a binary search to arrive at the right parameters that separates the data in a decent manner.</p> <h4 id="5-k-means-clustering">5. K-Means Clustering</h4> <p>So the main part of the implementation was to initialize centroids so that at least one point is assigned to a centroid. There were instances of bad initialization because all of them were random initialization. But this case has to be handled gracefully. I have tried generating random numbers, but getting random numbers from a data point was a bit better. Because, the centroid would lie within the region of data points. And there are less chances of bad centroid initialization. The pseudo code for the algorithm is as follows.</p> <p><strong>GenerateKCentorids ( TrainingData, K )</strong></p> <ol> <li>mapping_of_k = [ ]</li> <li>For K in range [ 1- K ] a. Random_Index = generate TraningData.Column random number in range [ 1 to number of Training Data.Rows ] b. Add Random_index to mapping_of_k</li> <li>centroids = [ ]</li> <li>For single_array in mapping_of_k a. temporary_hold = [ ] b. For index in range [ 1 to TrainingData.Column ] Add TrainingData[ single_array[index] ] [ index ] to temporary_hold c. add temporary_hold to centroids</li> <li>return centroids While generating initial centroids is a little twisted, implementing K-Means was quite straightforward. Only, one thing to take care about this implementation is re-initializing the centroids if a centroid is unassigned to any data points. Which is considered as a bad initialization case. Pseudo code for K-means is mentioned below.</li> </ol> <p><strong>RunKMeansClustering( K, TrainingData, Centroids )</strong></p> <ol> <li>Find euclidean distance between TrainingData and each Centroid</li> <li>Assign Each Data Points to the nearest Centroid and make a respective Bucket for all data points within a cluster.</li> <li>If any Bucket is empty Re-initialize the the Centroids by calling GenerateKCentorids restart from Step 1</li> <li>Find the mean of each Bucket consisting of data points.</li> <li>If the mean of Buckets matches respective centroids. Terminate the algorithm and return the bucket.</li> <li>Else make these means as respective new centroids and re-run from step 1. I am running K-means clustering repeatedly for 400 times with different centroids with a value of K set to</li> <li>For each answer I am calculating the inertia and finally selecting the best centroids based on the lowest inertia score. And before submitting I am adding 1 to each label as the cluster range is from 1 to 10 instead of 0 to 9. I have also tried with different values of K. I have tried values from 2 to 20 in increments of 2. For each K I’m running 10 iterations with different centroid values and finally choosing the best centroid values based on lowest inertia among them. These are the respective scores.</li> </ol> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/clustering5-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/clustering5-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/clustering5-1400.webp"></source> <img src="/assets/img/clustering5.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>As we could see from this analysis generally the lower inertia with smallest K and and largest Silhouette score gives better results. For K = 10 we get lowest inertia and highest Silhouette score for the Image data set and the same effect could be observed for K=3 in the Iris dataset.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Bhabaranjan Panigrahi. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>