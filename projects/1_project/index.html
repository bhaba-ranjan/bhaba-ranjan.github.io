<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Adaptive Boosting | Bhabaranjan Panigrahi</title> <meta name="author" content="Bhabaranjan Panigrahi"> <meta name="description" content="Boosing performance of models, with iterative improvements for Imbalance Dataset."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://profile.bpanigrani.com/projects/1_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Bhabaranjan </span>Panigrahi</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/"> Blogs</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Adaptive Boosting</h1> <p class="post-description">Boosing performance of models, with iterative improvements for Imbalance Dataset.</p> </header> <article> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
Source Code available in the repository
Github handle: bhaba-ranjan
Project: ada-boosting
Repository: https://github.com/bhaba-ranjan/ada-boosting    
---
</code></pre></div></div> <h4 id="1-data-analysis">1. Data Analysis</h4> <p>If we look at the data set the target label is binary and it contains a sequence of numbers representing the properties of that compound. The data set is imbalanced as mentioned in the problem statement there are <strong>722 inactive</strong> and <strong>78 active</strong> compounds. This imbalance is an indication that either we have to under-sample or over-sample our data to make unbiased predictions. I choose to go with over-sampling because undersampling could get rid of some records containing useful information. The sampling method used is random and with replacement. Also, the minority sample will be oversampled till its size reaches 75% of the inactive class in the training set. The selection of 75% is further explained in the Adaptive boosting part</p> <h4 id="2-feature-extraction">2. Feature Extraction</h4> <p>As the Data is already cleaned. I just converted it to a binary vector. Each place in the vector represents if the feature is present in the compound or not. Additionally, some features are removed based on some criteria which are discussed in the following section.</p> <h4 id="3-feature-subset-selection">3. Feature Subset Selection</h4> <p>I am using the SelectKBest with the Chi Square technique to extract only the top 25% features that are considered as a potential influencer in making the final prediction.</p> <p>Chi Square method used to find the correlation between features and categorical variables. The test is known as Chi-Square Test of Independence. In this test the null hypothesis says there is no correlation between two variables. In our case it is features and sentiment. The alternative hypothesis says there exists a correlation between them. Based on the test result we reject one hypothesis. But my motive here is not to do hypothesis testing but to use Chi-Square values. As higher value corresponds to higher correlation between feature and target variable. Based on the features and respective chi square value the features are selected.</p> <h4 id="4-adaptive-boosting">4. Adaptive Boosting</h4> <p>As the data is imbalanced, ada boosting helps a lot in successfully classifying minority samples by weighting them through the weight update method. I used Neural Networks as the base classifier. There are certain parameters that I had to tune in order to get a good score on the data.</p> <p>The first parameter is the amount of data that I sampled before training. I am using 10% of the training data every time I train a new classifier. In the process of developing the code I have experimented with several sample sizes. Sample sizes with more that 70% tend to over fit the ensemble. While sample size around 50% will dramatically improve either precision or recall after a point. The problem with sudden improvement is that generally precision tends to go up but recall tends to decline sharply, after a single iteration. I wanted a more gradual increase or decrease in any case. The thought process is that if it improvesgradually, itwouldbeeasiertochooseaspotwhereIcouldtradeoffbetweensomeprecision or recall value I want. Rather than compromising on recall because of sharp increase in precision.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/boosting1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/boosting1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/boosting1-1400.webp"></source> <img src="/assets/img/boosting1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>The horizontal axis is the ensemble size and respective precision and recall is in the vertical axis.</b> </div> <p>The second parameter to tune was the size of the neural network. It was fairly straight forward. As, the number of sample sizes I am training is only 10% out of the original dataset. I was sure that a deep model will overfit the sample. A shallow Neural Network is sufficiently capable to perform classification. Also, I used L1 regularization to further prevent overfitting on the data. Third parameter tuned is the stopping criteria. As we are using multiple iterations and picking up hard to classify samples with higher probability, it is obvious that the number of active compounds gets picked up more and the recall is taken care of. So I had to make sure that I did not lose precision. So, the early stopping criteria has higher precision [82%] criteria. Another parameter to tune is the learning rate. As my sample size is less, a higher learning rate(0.5) created complete imbalance in the sample set. I observed, sometimes it used to take all active compounds and other times it would take all inactive compounds. Instead, I decided to tradoff lower learning rate with increased ensemble size. For the ensemble size, I decided to put a sufficiently large number and then choose the best size after cross-validation and visualization.</p> <h4 id="5-ensemble-size-selection">5. Ensemble Size Selection</h4> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/boosting2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/boosting2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/boosting2-1400.webp"></source> <img src="/assets/img/boosting2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>It is evident to choose ensemble size of 12, as it is very accurate. However, there are other candidate answers. I chose 32 as the final ensemble size. Ensemble size 32 has more precision. It misspredicts 3 active compounds in the test set (totaling to 10). But, in the training set there are only 13 miss predictions in inactive compounds. Which means the classifier had to miss predict 12 in-active compounds (in case of size 12) in order to identify . So, this is a bad generalization case. This is the reason to choose ensemble size as 32, because it was able to generalize better. Here, the tradeoff I made for higher precision and a bit lower recall. The confusion matrix of size 32 is in the Jupyter notebook. The final accuracy is 77%. It is to choose the size of the ensemble and the trade off between precision and recall. I tried with an was not accurate. As it is a mean between precision and recall, with super higher precision and lower recall it could show us an average that is good enough but could not give similar results.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Bhabaranjan Panigrahi. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>